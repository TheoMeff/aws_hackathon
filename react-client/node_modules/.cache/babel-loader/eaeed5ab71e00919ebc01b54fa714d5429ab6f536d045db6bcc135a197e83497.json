{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { forwardRef, useEffect, useImperativeHandle, useRef } from 'react';\nimport { fireCancelableEvent } from '../internal/events';\nimport { nodeBelongs } from '../internal/utils/node-belongs';\nimport FileInputItem from './file-input-item';\nimport IconButtonItem from './icon-button-item';\nimport IconToggleButtonItem from './icon-toggle-button-item.js';\nimport MenuDropdownItem from './menu-dropdown-item';\nimport styles from './styles.css.js';\nconst ItemElement = forwardRef(({\n  item,\n  dropdownExpandToViewport,\n  tooltip,\n  setTooltip,\n  onItemClick,\n  onFilesChange\n}, ref) => {\n  const containerRef = useRef(null);\n  const buttonRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const buttonDropdownRef = useRef(null);\n  useImperativeHandle(ref, () => ({\n    focus: () => {\n      var _a, _b, _c;\n      (_a = buttonRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n      (_b = fileInputRef.current) === null || _b === void 0 ? void 0 : _b.focus();\n      (_c = buttonDropdownRef.current) === null || _c === void 0 ? void 0 : _c.focus();\n    }\n  }));\n  useEffect(() => {\n    if ((tooltip === null || tooltip === void 0 ? void 0 : tooltip.item) !== item.id) {\n      return;\n    }\n    const close = () => {\n      setTooltip(null);\n    };\n    const handlePointerDownEvent = event => {\n      var _a;\n      if (event.target && ((_a = containerRef.current) === null || _a === void 0 ? void 0 : _a.contains(event.target))) {\n        return;\n      }\n      close();\n    };\n    const handleKeyDownEvent = event => {\n      if (event.key === 'Escape') {\n        close();\n      }\n    };\n    const controller = new AbortController();\n    window.addEventListener('pointerdown', handlePointerDownEvent, {\n      signal: controller.signal\n    });\n    window.addEventListener('keydown', handleKeyDownEvent, {\n      signal: controller.signal\n    });\n    return () => {\n      controller.abort();\n    };\n  }, [item.id, tooltip, setTooltip]);\n  const onShowTooltipSoft = show => {\n    if (!(tooltip === null || tooltip === void 0 ? void 0 : tooltip.feedback)) {\n      setTooltip(show ? {\n        item: item.id,\n        feedback: false\n      } : null);\n    }\n  };\n  const onShowTooltipHard = show => {\n    if (!show && item.id !== (tooltip === null || tooltip === void 0 ? void 0 : tooltip.item)) {\n      return;\n    }\n    setTooltip(show ? {\n      item: item.id,\n      feedback: false\n    } : null);\n  };\n  const onClickHandler = event => {\n    const hasPopoverFeedback = 'popoverFeedback' in item && item.popoverFeedback;\n    if (hasPopoverFeedback) {\n      setTooltip({\n        item: item.id,\n        feedback: true\n      });\n    }\n    fireCancelableEvent(onItemClick, event.detail, event);\n  };\n  const onFilesChangeHandler = event => {\n    fireCancelableEvent(onFilesChange, event.detail, event);\n    setTooltip(null);\n  };\n  return React.createElement(\"div\", {\n    key: item.id,\n    className: styles['item-wrapper'],\n    ref: containerRef,\n    onPointerEnter: () => onShowTooltipSoft(true),\n    onPointerLeave: () => onShowTooltipSoft(false),\n    onFocus: event => {\n      // Showing no tooltip when the focus comes from inside the container.\n      // This is needed to prevent the tooltip after a menu closes with item selection or Escape.\n      if (event && event.relatedTarget && nodeBelongs(containerRef.current, event.relatedTarget)) {\n        return;\n      }\n      onShowTooltipHard(true);\n    },\n    onBlur: () => onShowTooltipHard(false)\n  }, item.type === 'icon-button' && React.createElement(IconButtonItem, {\n    ref: buttonRef,\n    item: item,\n    onItemClick: onClickHandler,\n    showTooltip: (tooltip === null || tooltip === void 0 ? void 0 : tooltip.item) === item.id,\n    showFeedback: !!(tooltip === null || tooltip === void 0 ? void 0 : tooltip.feedback),\n    onTooltipDismiss: () => setTooltip(null)\n  }), item.type === 'icon-toggle-button' && React.createElement(IconToggleButtonItem, {\n    ref: buttonRef,\n    item: item,\n    onItemClick: onClickHandler,\n    showTooltip: (tooltip === null || tooltip === void 0 ? void 0 : tooltip.item) === item.id,\n    showFeedback: !!(tooltip === null || tooltip === void 0 ? void 0 : tooltip.feedback),\n    onTooltipDismiss: () => setTooltip(null)\n  }), item.type === 'icon-file-input' && React.createElement(FileInputItem, {\n    ref: fileInputRef,\n    item: item,\n    onFilesChange: onFilesChangeHandler,\n    showTooltip: (tooltip === null || tooltip === void 0 ? void 0 : tooltip.item) === item.id,\n    onTooltipDismiss: () => setTooltip(null)\n  }), item.type === 'menu-dropdown' && React.createElement(MenuDropdownItem, {\n    ref: buttonDropdownRef,\n    item: item,\n    showTooltip: (tooltip === null || tooltip === void 0 ? void 0 : tooltip.item) === item.id,\n    onItemClick: onClickHandler,\n    expandToViewport: dropdownExpandToViewport,\n    onTooltipDismiss: () => setTooltip(null)\n  }));\n});\nexport default ItemElement;","map":{"version":3,"names":["React","forwardRef","useEffect","useImperativeHandle","useRef","fireCancelableEvent","nodeBelongs","FileInputItem","IconButtonItem","IconToggleButtonItem","MenuDropdownItem","styles","ItemElement","item","dropdownExpandToViewport","tooltip","setTooltip","onItemClick","onFilesChange","ref","containerRef","buttonRef","fileInputRef","buttonDropdownRef","focus","_a","current","_b","_c","id","close","handlePointerDownEvent","event","target","contains","handleKeyDownEvent","key","controller","AbortController","window","addEventListener","signal","abort","onShowTooltipSoft","show","feedback","onShowTooltipHard","onClickHandler","hasPopoverFeedback","popoverFeedback","detail","onFilesChangeHandler","createElement","className","onPointerEnter","onPointerLeave","onFocus","relatedTarget","onBlur","type","showTooltip","showFeedback","onTooltipDismiss","expandToViewport"],"sources":["/Users/theo/Library/CloudStorage/OneDrive-RackspaceInc/Documents/aws_hackathon/react-client/node_modules/src/button-group/item-element.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { forwardRef, useEffect, useImperativeHandle, useRef } from 'react';\n\nimport { ButtonProps } from '../button/interfaces.js';\nimport { ButtonDropdownProps } from '../button-dropdown/interfaces.js';\nimport { FileInputProps } from '../file-input/interfaces';\nimport { fireCancelableEvent, NonCancelableEventHandler } from '../internal/events';\nimport { nodeBelongs } from '../internal/utils/node-belongs';\nimport FileInputItem from './file-input-item';\nimport IconButtonItem from './icon-button-item';\nimport IconToggleButtonItem from './icon-toggle-button-item.js';\nimport { ButtonGroupProps } from './interfaces';\nimport MenuDropdownItem from './menu-dropdown-item';\n\nimport styles from './styles.css.js';\n\ninterface ItemElementProps {\n  item: ButtonGroupProps.Item;\n  dropdownExpandToViewport?: boolean;\n  tooltip: null | { item: string; feedback: boolean };\n  setTooltip: (tooltip: null | { item: string; feedback: boolean }) => void;\n  onItemClick?: NonCancelableEventHandler<ButtonGroupProps.ItemClickDetails> | undefined;\n  onFilesChange?: NonCancelableEventHandler<ButtonGroupProps.FilesChangeDetails> | undefined;\n}\n\nconst ItemElement = forwardRef(\n  (\n    { item, dropdownExpandToViewport, tooltip, setTooltip, onItemClick, onFilesChange }: ItemElementProps,\n    ref: React.Ref<ButtonProps.Ref>\n  ) => {\n    const containerRef = useRef<HTMLDivElement>(null);\n    const buttonRef = useRef<ButtonProps.Ref>(null);\n    const fileInputRef = useRef<FileInputProps.Ref>(null);\n    const buttonDropdownRef = useRef<ButtonDropdownProps.Ref>(null);\n\n    useImperativeHandle(ref, () => ({\n      focus: () => {\n        buttonRef.current?.focus();\n        fileInputRef.current?.focus();\n        buttonDropdownRef.current?.focus();\n      },\n    }));\n\n    useEffect(() => {\n      if (tooltip?.item !== item.id) {\n        return;\n      }\n\n      const close = () => {\n        setTooltip(null);\n      };\n\n      const handlePointerDownEvent = (event: PointerEvent) => {\n        if (event.target && containerRef.current?.contains(event.target as HTMLElement)) {\n          return;\n        }\n\n        close();\n      };\n\n      const handleKeyDownEvent = (event: KeyboardEvent) => {\n        if (event.key === 'Escape') {\n          close();\n        }\n      };\n\n      const controller = new AbortController();\n      window.addEventListener('pointerdown', handlePointerDownEvent, { signal: controller.signal });\n      window.addEventListener('keydown', handleKeyDownEvent, { signal: controller.signal });\n\n      return () => {\n        controller.abort();\n      };\n    }, [item.id, tooltip, setTooltip]);\n\n    const onShowTooltipSoft = (show: boolean) => {\n      if (!tooltip?.feedback) {\n        setTooltip(show ? { item: item.id, feedback: false } : null);\n      }\n    };\n\n    const onShowTooltipHard = (show: boolean) => {\n      if (!show && item.id !== tooltip?.item) {\n        return;\n      }\n\n      setTooltip(show ? { item: item.id, feedback: false } : null);\n    };\n\n    const onClickHandler = (event: CustomEvent<ButtonGroupProps.ItemClickDetails>) => {\n      const hasPopoverFeedback = 'popoverFeedback' in item && item.popoverFeedback;\n\n      if (hasPopoverFeedback) {\n        setTooltip({ item: item.id, feedback: true });\n      }\n\n      fireCancelableEvent(onItemClick, event.detail, event);\n    };\n\n    const onFilesChangeHandler = (event: CustomEvent<ButtonGroupProps.FilesChangeDetails>) => {\n      fireCancelableEvent(onFilesChange, event.detail, event);\n\n      setTooltip(null);\n    };\n\n    return (\n      <div\n        key={item.id}\n        className={styles['item-wrapper']}\n        ref={containerRef}\n        onPointerEnter={() => onShowTooltipSoft(true)}\n        onPointerLeave={() => onShowTooltipSoft(false)}\n        onFocus={event => {\n          // Showing no tooltip when the focus comes from inside the container.\n          // This is needed to prevent the tooltip after a menu closes with item selection or Escape.\n          if (event && event.relatedTarget && nodeBelongs(containerRef.current, event.relatedTarget)) {\n            return;\n          }\n          onShowTooltipHard(true);\n        }}\n        onBlur={() => onShowTooltipHard(false)}\n      >\n        {item.type === 'icon-button' && (\n          <IconButtonItem\n            ref={buttonRef}\n            item={item}\n            onItemClick={onClickHandler}\n            showTooltip={tooltip?.item === item.id}\n            showFeedback={!!tooltip?.feedback}\n            onTooltipDismiss={() => setTooltip(null)}\n          />\n        )}\n        {item.type === 'icon-toggle-button' && (\n          <IconToggleButtonItem\n            ref={buttonRef}\n            item={item}\n            onItemClick={onClickHandler}\n            showTooltip={tooltip?.item === item.id}\n            showFeedback={!!tooltip?.feedback}\n            onTooltipDismiss={() => setTooltip(null)}\n          />\n        )}\n        {item.type === 'icon-file-input' && (\n          <FileInputItem\n            ref={fileInputRef}\n            item={item}\n            onFilesChange={onFilesChangeHandler}\n            showTooltip={tooltip?.item === item.id}\n            onTooltipDismiss={() => setTooltip(null)}\n          />\n        )}\n        {item.type === 'menu-dropdown' && (\n          <MenuDropdownItem\n            ref={buttonDropdownRef}\n            item={item}\n            showTooltip={tooltip?.item === item.id}\n            onItemClick={onClickHandler}\n            expandToViewport={dropdownExpandToViewport}\n            onTooltipDismiss={() => setTooltip(null)}\n          />\n        )}\n      </div>\n    );\n  }\n);\n\nexport default ItemElement;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}