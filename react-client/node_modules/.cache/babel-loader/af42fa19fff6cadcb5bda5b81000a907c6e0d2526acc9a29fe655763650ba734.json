{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { useEffect, useState } from 'react';\nimport { useModalContext } from '../../context/modal-context';\nimport { useDOMAttribute } from '../use-dom-attribute';\nimport { useEffectOnUpdate } from '../use-effect-on-update';\nimport { useRandomId } from '../use-unique-id';\nimport { isInViewport } from './is-in-viewport';\nconst EVALUATE_COMPONENT_VISIBILITY_EVENT = 'awsui-evaluate-component-visibility';\n/**\n * This hook manages a boolean state (`evaluateComponentVisibility`) that toggles\n * whenever a custom DOM event (`EVALUATE_COMPONENT_VISIBILITY_EVENT`) is triggered.\n *\n * @returns\n */\nconst useEvaluateComponentVisibility = () => {\n  const [evaluateComponentVisibility, setEvaluateComponentVisibility] = useState(false);\n  useEffect(() => {\n    const handleEvaluateComponentVisibility = () => {\n      setEvaluateComponentVisibility(prev => !prev);\n    };\n    document.addEventListener(EVALUATE_COMPONENT_VISIBILITY_EVENT, handleEvaluateComponentVisibility);\n    return () => {\n      document.removeEventListener(EVALUATE_COMPONENT_VISIBILITY_EVENT, handleEvaluateComponentVisibility);\n    };\n  }, []);\n  return evaluateComponentVisibility;\n};\n/**\n * This function returns an object that needs to be spread onto the same\n * element as the `elementRef`, so that the data attribute is applied\n * correctly.\n */\nexport function usePerformanceMarks(name, enabled, elementRef, getDetails, dependencies) {\n  const id = useRandomId();\n  const {\n    isInModal\n  } = useModalContext();\n  const attributes = useDOMAttribute(elementRef, 'data-analytics-performance-mark', id);\n  const evaluateComponentVisibility = useEvaluateComponentVisibility();\n  useEffect(() => {\n    if (!enabled() || !elementRef.current || isInModal) {\n      return;\n    }\n    const elementVisible = elementRef.current.offsetWidth > 0 && elementRef.current.offsetHeight > 0 && getComputedStyle(elementRef.current).visibility !== 'hidden';\n    if (!elementVisible) {\n      return;\n    }\n    const timestamp = performance.now();\n    const cleanup = isInViewport(elementRef.current, inViewport => {\n      performance.mark(`${name}Rendered`, {\n        startTime: timestamp,\n        detail: Object.assign({\n          source: 'awsui',\n          instanceIdentifier: id,\n          inViewport\n        }, getDetails())\n      });\n    });\n    return cleanup;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffectOnUpdate(() => {\n    if (!enabled() || !elementRef.current || isInModal) {\n      return;\n    }\n    const elementVisible = elementRef.current.offsetWidth > 0 && elementRef.current.offsetHeight > 0 && getComputedStyle(elementRef.current).visibility !== 'hidden';\n    if (!elementVisible) {\n      return;\n    }\n    const timestamp = performance.now();\n    const cleanup = isInViewport(elementRef.current, inViewport => {\n      performance.mark(`${name}Updated`, {\n        startTime: timestamp,\n        detail: Object.assign({\n          source: 'awsui',\n          instanceIdentifier: id,\n          inViewport\n        }, getDetails())\n      });\n    });\n    return cleanup;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [evaluateComponentVisibility, ...dependencies]);\n  return attributes;\n}","map":{"version":3,"names":["useEffect","useState","useModalContext","useDOMAttribute","useEffectOnUpdate","useRandomId","isInViewport","EVALUATE_COMPONENT_VISIBILITY_EVENT","useEvaluateComponentVisibility","evaluateComponentVisibility","setEvaluateComponentVisibility","handleEvaluateComponentVisibility","prev","document","addEventListener","removeEventListener","usePerformanceMarks","name","enabled","elementRef","getDetails","dependencies","id","isInModal","attributes","current","elementVisible","offsetWidth","offsetHeight","getComputedStyle","visibility","timestamp","performance","now","cleanup","inViewport","mark","startTime","detail","Object","assign","source","instanceIdentifier"],"sources":["/Users/theo/Library/CloudStorage/OneDrive-RackspaceInc/Documents/aws_hackathon/react-client/node_modules/src/internal/hooks/use-performance-marks/index.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport { useEffect, useState } from 'react';\n\nimport { useModalContext } from '../../context/modal-context';\nimport { useDOMAttribute } from '../use-dom-attribute';\nimport { useEffectOnUpdate } from '../use-effect-on-update';\nimport { useRandomId } from '../use-unique-id';\nimport { isInViewport } from './is-in-viewport';\n\nconst EVALUATE_COMPONENT_VISIBILITY_EVENT = 'awsui-evaluate-component-visibility';\n\n/**\n * This hook manages a boolean state (`evaluateComponentVisibility`) that toggles\n * whenever a custom DOM event (`EVALUATE_COMPONENT_VISIBILITY_EVENT`) is triggered.\n *\n * @returns\n */\nconst useEvaluateComponentVisibility = () => {\n  const [evaluateComponentVisibility, setEvaluateComponentVisibility] = useState(false);\n\n  useEffect(() => {\n    const handleEvaluateComponentVisibility = () => {\n      setEvaluateComponentVisibility(prev => !prev);\n    };\n\n    document.addEventListener(EVALUATE_COMPONENT_VISIBILITY_EVENT, handleEvaluateComponentVisibility);\n\n    return () => {\n      document.removeEventListener(EVALUATE_COMPONENT_VISIBILITY_EVENT, handleEvaluateComponentVisibility);\n    };\n  }, []);\n\n  return evaluateComponentVisibility;\n};\n\n/**\n * This function returns an object that needs to be spread onto the same\n * element as the `elementRef`, so that the data attribute is applied\n * correctly.\n */\nexport function usePerformanceMarks(\n  name: string,\n  enabled: () => boolean,\n  elementRef: React.RefObject<HTMLElement>,\n  getDetails: () => Record<string, string | boolean | number | undefined>,\n  dependencies: React.DependencyList\n) {\n  const id = useRandomId();\n  const { isInModal } = useModalContext();\n  const attributes = useDOMAttribute(elementRef, 'data-analytics-performance-mark', id);\n  const evaluateComponentVisibility = useEvaluateComponentVisibility();\n\n  useEffect(() => {\n    if (!enabled() || !elementRef.current || isInModal) {\n      return;\n    }\n    const elementVisible =\n      elementRef.current.offsetWidth > 0 &&\n      elementRef.current.offsetHeight > 0 &&\n      getComputedStyle(elementRef.current).visibility !== 'hidden';\n\n    if (!elementVisible) {\n      return;\n    }\n\n    const timestamp = performance.now();\n\n    const cleanup = isInViewport(elementRef.current, inViewport => {\n      performance.mark(`${name}Rendered`, {\n        startTime: timestamp,\n        detail: {\n          source: 'awsui',\n          instanceIdentifier: id,\n          inViewport,\n          ...getDetails(),\n        },\n      });\n    });\n\n    return cleanup;\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffectOnUpdate(() => {\n    if (!enabled() || !elementRef.current || isInModal) {\n      return;\n    }\n    const elementVisible =\n      elementRef.current.offsetWidth > 0 &&\n      elementRef.current.offsetHeight > 0 &&\n      getComputedStyle(elementRef.current).visibility !== 'hidden';\n\n    if (!elementVisible) {\n      return;\n    }\n\n    const timestamp = performance.now();\n\n    const cleanup = isInViewport(elementRef.current, inViewport => {\n      performance.mark(`${name}Updated`, {\n        startTime: timestamp,\n        detail: {\n          source: 'awsui',\n          instanceIdentifier: id,\n          inViewport,\n          ...getDetails(),\n        },\n      });\n    });\n    return cleanup;\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [evaluateComponentVisibility, ...dependencies]);\n\n  return attributes;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}