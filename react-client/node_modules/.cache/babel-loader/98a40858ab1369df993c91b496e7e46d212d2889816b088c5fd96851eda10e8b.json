{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nvar _AlertFlashContentController_listeners, _AlertFlashContentController_cleanups, _AlertFlashContentController_provider, _AlertFlashContentController_scheduleUpdate;\nimport { __classPrivateFieldGet, __classPrivateFieldSet } from \"tslib\";\nimport debounce from '../../debounce';\nimport { reportRuntimeApiWarning } from '../helpers/metrics';\nexport class AlertFlashContentController {\n  constructor() {\n    _AlertFlashContentController_listeners.set(this, []);\n    _AlertFlashContentController_cleanups.set(this, new Map());\n    _AlertFlashContentController_provider.set(this, void 0);\n    _AlertFlashContentController_scheduleUpdate.set(this, debounce(() => __classPrivateFieldGet(this, _AlertFlashContentController_listeners, \"f\").forEach(listener => {\n      if (__classPrivateFieldGet(this, _AlertFlashContentController_provider, \"f\")) {\n        const cleanup = listener(__classPrivateFieldGet(this, _AlertFlashContentController_provider, \"f\"));\n        __classPrivateFieldGet(this, _AlertFlashContentController_cleanups, \"f\").set(listener, cleanup);\n      }\n    }), 0));\n    this.registerContentReplacer = content => {\n      if (__classPrivateFieldGet(this, _AlertFlashContentController_provider, \"f\")) {\n        reportRuntimeApiWarning('alert-flash-content', `Cannot call \\`registerContentReplacer\\` with new provider: provider with id \"${__classPrivateFieldGet(this, _AlertFlashContentController_provider, \"f\").id}\" already registered.`);\n        return;\n      }\n      __classPrivateFieldSet(this, _AlertFlashContentController_provider, content, \"f\");\n      // Notify existing components if registration happens after the components are rendered.\n      __classPrivateFieldGet(this, _AlertFlashContentController_scheduleUpdate, \"f\").call(this);\n    };\n    this.clearRegisteredReplacer = () => {\n      __classPrivateFieldSet(this, _AlertFlashContentController_provider, undefined, \"f\");\n    };\n    this.initialCheck = context => {\n      var _a;\n      if ((_a = __classPrivateFieldGet(this, _AlertFlashContentController_provider, \"f\")) === null || _a === void 0 ? void 0 : _a.initialCheck) {\n        return __classPrivateFieldGet(this, _AlertFlashContentController_provider, \"f\").initialCheck(context);\n      }\n      return false;\n    };\n    this.onContentRegistered = listener => {\n      if (__classPrivateFieldGet(this, _AlertFlashContentController_provider, \"f\")) {\n        const cleanup = listener(__classPrivateFieldGet(this, _AlertFlashContentController_provider, \"f\"));\n        __classPrivateFieldGet(this, _AlertFlashContentController_listeners, \"f\").push(listener);\n        __classPrivateFieldGet(this, _AlertFlashContentController_cleanups, \"f\").set(listener, cleanup);\n      } else {\n        __classPrivateFieldGet(this, _AlertFlashContentController_listeners, \"f\").push(listener);\n      }\n      return () => {\n        var _a;\n        (_a = __classPrivateFieldGet(this, _AlertFlashContentController_cleanups, \"f\").get(listener)) === null || _a === void 0 ? void 0 : _a();\n        __classPrivateFieldSet(this, _AlertFlashContentController_listeners, __classPrivateFieldGet(this, _AlertFlashContentController_listeners, \"f\").filter(item => item !== listener), \"f\");\n        __classPrivateFieldGet(this, _AlertFlashContentController_cleanups, \"f\").delete(listener);\n      };\n    };\n  }\n  installPublic(api = {}) {\n    var _a;\n    (_a = api.registerContentReplacer) !== null && _a !== void 0 ? _a : api.registerContentReplacer = this.registerContentReplacer;\n    return api;\n  }\n  installInternal(internalApi = {}) {\n    var _a, _b, _c;\n    (_a = internalApi.clearRegisteredReplacer) !== null && _a !== void 0 ? _a : internalApi.clearRegisteredReplacer = this.clearRegisteredReplacer;\n    (_b = internalApi.onContentRegistered) !== null && _b !== void 0 ? _b : internalApi.onContentRegistered = this.onContentRegistered;\n    (_c = internalApi.initialCheck) !== null && _c !== void 0 ? _c : internalApi.initialCheck = this.initialCheck;\n    return internalApi;\n  }\n}\n_AlertFlashContentController_listeners = new WeakMap(), _AlertFlashContentController_cleanups = new WeakMap(), _AlertFlashContentController_provider = new WeakMap(), _AlertFlashContentController_scheduleUpdate = new WeakMap();","map":{"version":3,"names":["debounce","reportRuntimeApiWarning","AlertFlashContentController","constructor","_AlertFlashContentController_listeners","set","_AlertFlashContentController_cleanups","Map","_AlertFlashContentController_provider","_AlertFlashContentController_scheduleUpdate","__classPrivateFieldGet","forEach","listener","cleanup","registerContentReplacer","content","id","__classPrivateFieldSet","call","clearRegisteredReplacer","undefined","initialCheck","context","_a","onContentRegistered","push","get","filter","item","delete","installPublic","api","installInternal","internalApi","_b","_c"],"sources":["/Users/theo/Library/CloudStorage/OneDrive-RackspaceInc/Documents/aws_hackathon/react-client/node_modules/src/internal/plugins/controllers/alert-flash-content.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport { ReactNode } from 'react';\n\nimport debounce from '../../debounce';\nimport { reportRuntimeApiWarning } from '../helpers/metrics';\n\n// this code should not depend on React typings, because it is portable between major versions\ninterface RefShim<T> {\n  current: T | null;\n}\n\ninterface AlertFlashContentContext {\n  instanceId: string;\n  type: string;\n  headerRef: RefShim<HTMLElement>;\n  contentRef: RefShim<HTMLElement>;\n}\n\ninterface AlertFlashContentInitialContext {\n  instanceId: string;\n  type: string;\n  header?: ReactNode;\n  content?: ReactNode;\n}\n\nexport type ReplacementType = 'original' | 'remove' | 'replaced';\n\ninterface ReplacementApi {\n  hideHeader(): void;\n  restoreHeader(): void;\n  replaceHeader(replacer: (container: HTMLElement) => void): void;\n  hideContent(): void;\n  restoreContent(): void;\n  replaceContent(replacer: (container: HTMLElement) => void): void;\n}\n\nexport interface AlertFlashContentResult {\n  update: () => void;\n  unmount: (containers: { replacementHeaderContainer: HTMLElement; replacementContentContainer: HTMLElement }) => void;\n}\n\nexport interface AlertFlashContentConfig {\n  id: string;\n  runReplacer: (context: AlertFlashContentContext, replacementApi: ReplacementApi) => AlertFlashContentResult;\n  initialCheck?: (context: AlertFlashContentInitialContext) => boolean;\n}\n\ntype AlertFlashContentRegistrationListener = (provider: AlertFlashContentConfig) => () => void;\n\nexport interface AlertFlashContentApiPublic {\n  registerContentReplacer(config: AlertFlashContentConfig): void;\n}\n\nexport interface AlertFlashContentApiInternal {\n  clearRegisteredReplacer(): void;\n  onContentRegistered(listener: AlertFlashContentRegistrationListener): () => void;\n  initialCheck(context: AlertFlashContentInitialContext): boolean;\n}\n\nexport class AlertFlashContentController {\n  #listeners: Array<AlertFlashContentRegistrationListener> = [];\n  #cleanups = new Map<AlertFlashContentRegistrationListener, () => void>();\n  #provider?: AlertFlashContentConfig;\n\n  #scheduleUpdate = debounce(\n    () =>\n      this.#listeners.forEach(listener => {\n        if (this.#provider) {\n          const cleanup = listener(this.#provider);\n          this.#cleanups.set(listener, cleanup);\n        }\n      }),\n    0\n  );\n\n  registerContentReplacer = (content: AlertFlashContentConfig) => {\n    if (this.#provider) {\n      reportRuntimeApiWarning(\n        'alert-flash-content',\n        `Cannot call \\`registerContentReplacer\\` with new provider: provider with id \"${this.#provider.id}\" already registered.`\n      );\n      return;\n    }\n    this.#provider = content;\n\n    // Notify existing components if registration happens after the components are rendered.\n    this.#scheduleUpdate();\n  };\n\n  clearRegisteredReplacer = () => {\n    this.#provider = undefined;\n  };\n\n  initialCheck = (context: AlertFlashContentInitialContext): boolean => {\n    if (this.#provider?.initialCheck) {\n      return this.#provider.initialCheck(context);\n    }\n    return false;\n  };\n\n  onContentRegistered = (listener: AlertFlashContentRegistrationListener) => {\n    if (this.#provider) {\n      const cleanup = listener(this.#provider);\n      this.#listeners.push(listener);\n      this.#cleanups.set(listener, cleanup);\n    } else {\n      this.#listeners.push(listener);\n    }\n    return () => {\n      this.#cleanups.get(listener)?.();\n      this.#listeners = this.#listeners.filter(item => item !== listener);\n      this.#cleanups.delete(listener);\n    };\n  };\n\n  installPublic(api: Partial<AlertFlashContentApiPublic> = {}): AlertFlashContentApiPublic {\n    api.registerContentReplacer ??= this.registerContentReplacer;\n    return api as AlertFlashContentApiPublic;\n  }\n\n  installInternal(internalApi: Partial<AlertFlashContentApiInternal> = {}): AlertFlashContentApiInternal {\n    internalApi.clearRegisteredReplacer ??= this.clearRegisteredReplacer;\n    internalApi.onContentRegistered ??= this.onContentRegistered;\n    internalApi.initialCheck ??= this.initialCheck;\n    return internalApi as AlertFlashContentApiInternal;\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}